# ------------------------------------------------------------
# 📁 감염병_정제병합코드_2019_2024.py
# ✅ 목적:
#   - 2019~2024년 질병관리청 감염병 발생 데이터 통합 및 정제
#   - 원본 CSV (EUC-KR) 및 엑셀 파일을 UTF-8로 통일하여 분석 준비
#
# ✅ 주요 작업:
#   1. 각 연도별 감염병 데이터 파일 읽기 (2019~2023: CSV, 2024: 엑셀 기반)
#   2. 지역명(17개 시도)과 감염병명(67종) 컬럼 일치화
#   3. 연도별 컬럼 추가 및 지역명 지정
#   4. 6개년 데이터를 하나의 DataFrame으로 병합
#   5. UTF-8-sig 인코딩으로 최종 CSV 저장 (엑셀 호환)
#
# ✅ 결과물:
#   - 파일명: 2019_2024_감염병_정제통합_UTF8.csv
#   - 구성: [연도, 지역, 에볼라바이러스병, 마버그열, ..., @엠폭스]
#
# 🔧 사용 전제:
#   - 각 연도별 파일이 동일한 구조로 존재해야 함
#   - 2024년도 데이터는 별도 전처리된 CSV 파일 사용 (엑셀에서 추출)
# ------------------------------------------------------------

import pandas as pd

# 감염병 컬럼명 리스트 (엑셀에서 추출한 실제 이름 기준, 총 67개)
columns_final = [
    "지역", "에볼라바이러스병", "마버그열", "라싸열", "크리미안콩고출혈열", "남아메리카출혈열",
    "리프트밸리열", "두창", "페스트", "탄저", "보툴리눔독소증", "야토병", 
    "중증급성호흡기증후군(SARS)", "중동호흡기증후군(MERS)", "동물인플루엔자인체감염증",
    "신종인플루엔자", "디프테리아", "수두", "홍역", "콜레라", "장티푸스", "파라티푸스",
    "세균성이질", "장출혈성대장균감염증", "A형간염", "백일해", "유행성이하선염", "풍진",
    "폴리오", "수막구균감염증", "헤모필루스인플루엔자균감염증", "폐렴구균감염증",
    "한센병", "성홍열", "VRSA감염증", "CRE감염증", "카바페넴내성장내세균속균종(CPE)",
    "MRPA감염증", "MRAB감염증", "MRKP감염증", "MRSA감염증", "MRSE감염증",
    "결핵", "말라리아", "레지오넬라증", "비브리오패혈증", "발진열", "발진티푸스",
    "쯔쯔가무시증", "렙토스피라증", "브루셀라증", "공수병", "신증후군출혈열", "AIDS",
    "매독", "CJD", "황열", "뎅기열", "웨스트나일열", "치쿤구니야열", "지카바이러스감염증",
    "이질아메바증", "톤질", "그람음성균혈증", "매독2차", "임질", "성병클라미디아감염증", "@엠폭스"
]

# 17개 시도명
region_names_17 = [
    "서울특별시", "부산광역시", "대구광역시", "인천광역시", "광주광역시", "대전광역시",
    "울산광역시", "경기도", "강원특별자치도", "충청북도", "충청남도", "전라북도",
    "전라남도", "경상북도", "경상남도", "제주특별자치도", "세종특별자치시"
]

# 연도별 CSV 파일 경로 (UTF-8 변환된 버전)
file_paths = {
    "2019": "2019_전국_감염병_utf8.csv",
    "2020": "2020_전국_감염병_utf8.csv",
    "2021": "2021_전국_감염병_utf8.csv",
    "2022": "2022_전국_감염병_utf8.csv",
    "2023": "2023_전국_감염병_utf8.csv"
}

# 정제된 데이터프레임 모으기
cleaned_dfs = []
for year, path in file_paths.items():
    df = pd.read_csv(path, header=None).iloc[1:18]  # 상위 17개 지역만 사용
    df.columns = columns_final
    df.insert(0, "연도", int(year))
    df["지역"] = region_names_17
    cleaned_dfs.append(df)

# 2024년도: 엑셀에서 전처리된 UTF-8 CSV 사용
df_2024 = pd.read_csv("2024_감염병_정제_지역컬럼반영_UTF8.csv")
df_2024.columns = ["지역"] + columns_final[1:]
df_2024 = df_2024.iloc[:17]  # 17개 시도만
df_2024.insert(0, "연도", 2024)
df_2024["지역"] = region_names_17

# 모든 연도 병합
merged_df = pd.concat(cleaned_dfs + [df_2024], ignore_index=True)

# 최종 저장
merged_df.to_csv("2019_2024_감염병_정제통합_UTF8.csv", index=False, encoding="utf-8-sig")
